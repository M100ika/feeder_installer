@startuml
start
:Инициализация серийного порта Arduino (9600 bps);
:Инициализация HX711;
partition Arduino {
  :Ожидание подключения к серийному порту;
  :Настройка пина DOUT;
  :Настройка пина SCK;
  :Чтение данных с HX711;
  :Преобразование данных АЦП в число;
  :Отправка данных через серийный порт при получении команды;
}
:main();
partition RaspberryPi {
  :Инициализация соединения с Arduino ('/dev/ttyACM0');
  if (Соединение установлено?) then (да)
    else (нет)
    :Вывод ошибки подключения;
    stop
  endif
  :Настройка калибровочных параметров (offset, scale);
  :Отправка команды на Arduino для получения данных;
  while (Ожидание данных) is (Данные получены)
    :Чтение данных с серийного порта;
  endwhile
  :Преобразование байтов в число;
  :Подготовка к измерению веса;
  :Считывание измерений для стабилизации;
  :Финальное измерение веса;
  :Применение масштаба и смещения;
  :Вычисление итогового веса;
  :Вывод веса;
  :Отключение от Arduino;
}
stop
@enduml
